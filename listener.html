<!DOCTYPE html>
<html>
<head>
  <title>Doorbell Listener</title>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
  
</head>
<body>
  <h1>Doorbell Listener (Keep this tab open)</h1>
  <audio id="doorbellSound" src="doorbell.wav" preload="auto"></audio>
  <div id="alert" style="display: none; background: #FF4136; color: white; padding: 10px;">
    ðŸš¨ Someone is at the door!
  </div>
  <script>
    const firebaseConfig = { apiKey: "AIzaSyA4CgSl4dc6c-Gnex8wcDNuFZTU2ACaXv8",
  authDomain: "doorbell-961eb.firebaseapp.com",
  databaseURL: "https://doorbell-961eb-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "doorbell-961eb",
  storageBucket: "doorbell-961eb.firebasestorage.app",
  messagingSenderId: "960442463106",
  appId: "1:960442463106:web:d5daa55b166315c02ad59b",
  measurementId: "G-DNFHDXH2E7" };
  firebase.initializeApp(firebaseConfig);

  // Play sound when doorbell rings
  const doorbellSound = document.getElementById("doorbellSound");
    
  firebase.database().ref("doorbell").on("value", (snapshot) => {
      if (snapshot.val()?.ring) {
        // Show visual alert
        const alertDiv = document.getElementById("alert");
        alertDiv.style.display = "block";
        setTimeout(() => alertDiv.style.display = "none", 3000); // Hide after 3 seconds

        doorbellSound.currentTime = 0; // Reset sound to start
        // Play sound
        doorbellSound.play().catch(e => console.error("Audio error:", e));
        

        // Reset doorbell
        firebase.database().ref("doorbell").update({ ring: false });
      }
    });
  
  </script>
</body>
</html>
